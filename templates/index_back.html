{% extends "base.html" %}

{% block content %}
<main class="layout-main">

  {# ===================== PAGE HEADER ===================== #}
  <section class="page-header">
    <h1 class="page-title">All entries</h1>
    <p class="page-subtitle">
      Your paintings, memories, diary notes, and moments.
    </p>
  </section>

  {# ===================== MAIN GALLERY GRID ===================== #}
  {% if entries and entries|length > 0 %}
  <section class="section-block">
    <h2 class="section-title-sm">Gallery</h2>
    <div class="cards">
      {% for e in entries %}
        {% include "partials/card.html" %}
      {% endfor %}
    </div>
  </section>
  
  {% else %}
    <section class="gallery-header">
      <h2 class="section-title">Gallery</h2>
      <p class="section-subtitle">
        No entries yet. Start by adding your first memory or painting.
      </p>
    </section>
  {% endif %}

  {# ===================== RECENT REFLECTIONS ===================== #}
  {% if reflections and reflections|length > 0 %}
    <section class="reflection-section fade-in">
      <div class="section-title-row">
        <h2 class="section-title">Recent reflections</h2>
        <a href="{{ url_for('daily_reflection') }}" class="home-card-link">
          Open reflection journal â†’
        </a>
      </div>
      <p class="section-subtitle">
        Your latest <strong>Daily reflection</strong> notes, in one cozy row.
      </p>

      <ul class="reflection-list">
        {% for r in reflections %}
          <li class="reflection-card">
            <a href="{{ url_for('entry_detail', entry_id=r.id) }}" class="reflection-link">
              <div class="reflection-title-row">
                <span class="reflection-emoji">ðŸ““</span>
                <span class="reflection-title">
                  {{ r.title }}
                </span>
              </div>

              <div class="reflection-meta">
                <span class="reflection-date">{{ r.date }}</span>
                {% if r.mood %}
                  <span class="reflection-mood">{{ r.mood }}</span>
                {% endif %}
              </div>

              {% if r.notes %}
                <p class="reflection-snippet">
                  {{ r.notes[:140] }}{% if r.notes|length > 140 %}â€¦{% endif %}
                </p>
              {% endif %}
            </a>
          </li>
        {% endfor %}
      </ul>
    </section>
  {% endif %}

  {# ===================== DREAMS & GOALS STRIP ===================== #}
  {% if dream_entries and dream_entries|length > 0 %}
    <section class="dreams-section fade-in">
      <h2 class="section-title">Dreams &amp; goals</h2>
      <p class="section-subtitle">
        These entries are tagged as <code>dream</code> / <code>goal</code> or live in your
        <strong>Goals</strong> collection. They also appear on your <strong>Dreamboard</strong>.
      </p>

      <div class="dreams-list">
        {% for d in dream_entries %}
          <article class="dream-card">
            <header class="dream-header">
              <h3 class="dream-title">{{ d.title }}</h3>
            </header>

            <div class="dream-meta-row">
              {% if d.dream_theme %}
                <span class="chip chip-soft">
                  {% if d.dream_theme|lower == 'travel' %}âœˆ{% endif %}
                  {{ d.dream_theme }}
                </span>
              {% endif %}

              {% if d.dream_priority %}
                <span class="chip chip-priority">{{ d.dream_priority }}</span>
              {% endif %}
            </div>

            {# progress bar #}
            <div class="dream-progress-row">
              {% set prog_raw = d.dream_progress or 0 %}
              {% set prog = prog_raw|int %}
              <div class="progress-track">
                <div class="progress-fill" style="width: {{ prog }}%;"></div>
              </div>
              <span class="progress-label">
                {{ prog }}%
              </span>
            </div>

            {% if d.notes %}
              <p class="dream-notes">
                {{ d.notes }}
              </p>
            {% endif %}

            <footer class="dream-footer">
              {% if d.dream_target_date %}
                <span class="dream-date-label">
                  {{ d.dream_target_date }}
                </span>
              {% elif d.date %}
                <span class="dream-date-label">
                  {{ d.date }}
                </span>
              {% endif %}
            </footer>
          </article>
        {% endfor %}
      </div>
    </section>
  {% endif %}

</main>
{% endblock %}
